ARG __alpine_version=3.23
FROM alpine:${__alpine_version}

# Alpine packages versions: https://pkgs.alpinelinux.org/
ARG __curl_version=8.17.0-r1
ARG __git_version=2.52.0-r0
ARG __mandoc_version=1.14.6-r13
ARG __shellcheck_version=0.11.0-r0
ARG __shfmt_version=3.11.0-r5
ARG __shunit2_version=2.1.8-r1

ARG __gid=1001
ARG __gname=dev
ARG __uid=1001
ARG __uname=dev
ARG __user_home=/home/${__uname}

RUN apk update --no-cache \
    && apk upgrade --no-cache \
    && apk add --no-cache \
      curl=${__curl_version} \
      git=${__git_version} \
      mandoc=${__mandoc_version} \
      shellcheck=${__shellcheck_version} \
      shfmt=${__shfmt_version} \
      shunit2=${__shunit2_version} \
    && addgroup -g ${__gid} ${__gname} \
    && adduser -u ${__uid} -G ${__gname} -D -h ${__user_home} ${__uname}

# minimal healthcheck, we do not really need it here
HEALTHCHECK CMD exit 0

USER ${__uname}
